---
import type { ImageMetadata } from 'astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import BaseHead from '../components/BaseHead.astro';

interface Props {
  title: string;
  description: string;
  image?: ImageMetadata;
  showHeader?: boolean;
  className?: string;
}

const { title, description, image, showHeader = true, className } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={title} description={description} image={image} />
    <script is:inline>
      (() => {
        if (typeof window === 'undefined') return;
        const root = document.documentElement;
        const prefersDark = window.matchMedia?.('(prefers-color-scheme: dark)').matches ?? false;
        let theme = 'light';
        try {
          const stored = localStorage.getItem('theme');
          theme = stored || (prefersDark ? 'dark' : 'light');
        } catch (err) {
          theme = prefersDark ? 'dark' : 'light';
        }
        root.dataset.theme = theme;
        root.style.colorScheme = theme;
      })();
    </script>
  </head>
  <body>
    <a
      href="#page-content"
      class="sr-only focus:not-sr-only focus:fixed focus:left-4 focus:top-4 focus:z-50 focus:rounded-full focus:bg-[var(--color-accent)] focus:px-4 focus:py-2 focus:text-sm focus:font-semibold focus:text-[var(--color-accent-contrast)]"
    >
      Skip to content
    </a>
    {showHeader && <Header />}
    <main id="page-content" class={`min-h-screen ${className ?? ''}`}>
      <slot />
    </main>
    <Footer />
  </body>
</html>
