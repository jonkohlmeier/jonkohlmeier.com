---
import { getCollection } from 'astro:content';
import SiteLayout from '../layouts/SiteLayout.astro';
import HeroSection from '../components/HeroSection.astro';
import SectionHeader from '../components/SectionHeader.astro';
import ContentGrid from '../components/ContentGrid.astro';
import PostPreviewCard from '../components/PostPreviewCard.astro';

const posts = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<SiteLayout
  title="Puffs of Smoke"
  description="Pipes, product, and leadership musings from technologist Jon Kohlmeier."
>
  <HeroSection
    eyebrow="Welcome In"
    title="Every good idea starts with a good conversation."
  >
    <div slot="extra" class="hero-copy text-lg text-subtle">
      <p class="hero-copy__subheading text-sm uppercase tracking-[0.3em] text-muted">…and maybe a bit of smoke in the air</p>
      <p>
        I’m Jon Kohlmeier. I build RevOps systems that help teams work with more clarity, connection,
        and craft.
      </p>
      <p>
        Puffs of Smoke is my study — a place for reflection and slow thinking, where curiosity lingers and
        half-formed ideas find shape.
      </p>
      <p>
        Here, I write to make sense of work, technology, and the quiet, human moments that hold it all
        together.
      </p>
      <div class="flex flex-wrap gap-3" data-hero-cta>
        <a class="btn btn-primary" href="/writing/">Enter the Study</a>
        <a class="btn btn-ghost" href="/about/">My Story</a>
      </div>
    </div>
  </HeroSection>

  <section class="hero-ribbon">
    <div class="container-page hero-ribbon__inner">
      <p class="hero-ribbon__eyebrow">Pull up a chair.</p>
      <p class="hero-ribbon__body">
        This is where I think out loud about work, faith, and the craft of making things better. Most of what I write
        starts with a good conversation, a quiet evening in the study, or a bit of smoke curling toward the ceiling.
      </p>
    </div>
  </section>

  <section class="section-gap section-study">
    <div class="container-page study-panel space-y-8">
      <SectionHeader
        eyebrow="Puffs from the Study"
        title="Pull up a chair"
        description="Here’s what I’ve been thinking about lately. Ideas that start in conversation, take shape over coffee, and stick around long enough to be worth sharing."
      />
      <ContentGrid>
        {posts.map((post) => (
          <PostPreviewCard post={post} />
        ))}
      </ContentGrid>
    </div>
  </section>

</SiteLayout>
