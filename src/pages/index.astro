---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import SiteLayout from '../layouts/SiteLayout.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Avatar from '../assets/profile-pic.jpg';

const posts = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---

<SiteLayout title="Puffs of Smoke" description="Pipes, product, and leadership musings from technologist Jonathan Kohlmeier.">
  <section class="grid gap-10 lg:grid-cols-[1.6fr,1fr] lg:items-center">
    <div class="space-y-6">
      <p class="inline-flex items-center rounded-full border border-amber-300/40 bg-amber-300/10 px-3 py-1 text-xs uppercase tracking-[0.4em] text-amber-200">
        Home base
      </p>
      <h1 class="text-4xl font-bold text-slate-100 sm:text-5xl md:text-6xl">
        Building trustworthy products, RevOps systems, and the teams that power them.
      </h1>
      <p class="max-w-2xl text-lg text-slate-300">
        I’m Jonathan Kohlmeier—an engineering-minded RevOps leader blending technology, operations, and
        hospitality. Puffs of Smoke is where I publish essays on leadership, tooling, and the occasional
        pipe, plus experiments that help people-first teams grow.
      </p>
      <div class="flex flex-wrap gap-3">
        <a
          class="rounded-full bg-amber-300 px-5 py-2 text-sm font-semibold text-slate-900 transition hover:bg-amber-200"
          href="/writing/"
        >
          Read the latest essays
        </a>
        <a
          class="rounded-full border border-slate-700 px-5 py-2 text-sm font-semibold text-slate-200 transition hover:border-slate-500 hover:text-amber-200"
          href="/services/"
        >
          Explore advisory services
        </a>
      </div>
    </div>
    <aside class="mx-auto w-full max-w-xs rounded-3xl border border-slate-800/70 bg-slate-900/60 p-6 text-sm text-slate-300 shadow-xl">
      <div class="mx-auto mb-4 h-28 w-28 overflow-hidden rounded-full border border-slate-700 shadow-lg">
        <Image src={Avatar} alt="Jonathan Kohlmeier" width={224} height={224} />
      </div>
      <p class="text-center font-semibold text-slate-100">Jonathan Kohlmeier</p>
      <p class="text-center text-xs uppercase tracking-[0.3em] text-slate-500">
        Cedar Rapids · Remote-friendly
      </p>
      <ul class="mt-4 space-y-2">
        <li><strong>Currently:</strong> Director of Web Development @ McNary Marketing</li>
        <li><strong>Domains:</strong> RevOps, product ops, systems thinking, web performance</li>
        <li><strong>Also:</strong> Co-host of <a href="https://twistoflemonpod.com" target="_blank" rel="noopener noreferrer">Life with a Twist of Lemon</a></li>
      </ul>
    </aside>
  </section>

  <section class="mt-16 space-y-6">
    <div class="flex items-baseline justify-between gap-4">
      <h2 class="text-2xl font-semibold text-slate-100">Fresh writing</h2>
      <a class="text-sm font-semibold text-amber-300 hover:text-amber-200" href="/writing/">Browse all</a>
    </div>
    <div class="grid gap-6 md:grid-cols-3">
      {posts.map((post) => (
        <article class="group flex h-full flex-col justify-between rounded-3xl border border-slate-800/70 bg-slate-900/60 p-6 shadow-xl transition hover:border-amber-300/60 hover:shadow-amber-500/20">
          <div class="space-y-4">
            <p class="text-xs uppercase tracking-[0.4em] text-slate-500">
              <FormattedDate date={post.data.pubDate} />
            </p>
            <h3 class="text-xl font-semibold text-slate-100 group-hover:text-amber-300">
              <a href={`/blog/${post.id}/`}>{post.data.title}</a>
            </h3>
            <p class="text-sm text-slate-300">{post.data.description}</p>
          </div>
          <a
            class="mt-6 inline-flex items-center gap-2 text-sm font-semibold text-amber-300 hover:text-amber-200"
            href={`/blog/${post.id}/`}
          >
            Read essay
            <span aria-hidden="true">→</span>
          </a>
        </article>
      ))}
    </div>
  </section>

  <section class="mt-20 grid gap-10 lg:grid-cols-2">
    <div class="rounded-3xl border border-slate-800/70 bg-slate-900/60 p-8 shadow-xl">
      <h2 class="text-2xl font-semibold text-slate-100">Ways to collaborate</h2>
      <p class="mt-4 text-slate-300">
        Need a RevOps audit, product ops alignment, or fractional leadership? I help teams untangle
        systems, ship improvements, and build the reporting that keeps stakeholders confident.
      </p>
      <ul class="mt-6 space-y-3 text-sm text-slate-300">
        <li>• Fractional RevOps & engineering leadership</li>
        <li>• Go-to-market system diagnostics & dashboards</li>
        <li>• Technical due diligence for acquisitions</li>
        <li>• Playbooks and workshops tailored for your team</li>
      </ul>
      <a
        class="mt-6 inline-flex rounded-full bg-amber-300 px-5 py-2 text-sm font-semibold text-slate-900 transition hover:bg-amber-200"
        href="/contact/"
      >
        Start a conversation
      </a>
    </div>
    <div class="rounded-3xl border border-slate-800/70 bg-slate-900/60 p-8 shadow-xl">
      <h2 class="text-2xl font-semibold text-slate-100">Stay in the smoke circle</h2>
      <p class="mt-4 text-slate-300">
        Join the newsletter for a monthly briefing on leadership experiments, tooling deep dives, and
        curated reads worth your attention.
      </p>
      <form
        class="mt-6 flex flex-col gap-3 text-sm"
        action="https://buttondown.email/api/emails/embed-subscribe/jonkohlmeier"
        method="post"
        target="_blank"
      >
        <label class="text-xs uppercase tracking-[0.3em] text-slate-500" for="email">
          Email address
        </label>
        <input
          id="email"
          name="email"
          type="email"
          required
          placeholder="you@example.com"
          class="w-full rounded-full border border-slate-700 bg-slate-950 px-4 py-3 text-slate-100 focus:border-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-300/60"
        />
        <button
          type="submit"
          class="inline-flex w-full items-center justify-center rounded-full bg-amber-300 px-4 py-2 font-semibold text-slate-900 transition hover:bg-amber-200"
        >
          Subscribe
        </button>
        <p class="text-xs text-slate-500">
          Powered by Buttondown. No spam—just reflections, experiments, and resources.
        </p>
      </form>
    </div>
  </section>
</SiteLayout>
