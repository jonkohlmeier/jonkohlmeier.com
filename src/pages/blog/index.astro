---
import { getCollection } from 'astro:content';
import SiteLayout from '../../layouts/SiteLayout.astro';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<SiteLayout title="Writing · Puffs of Smoke" description="Essays on RevOps, leadership, technology, and the finer things.">
  <section class="space-y-4 text-center">
    <p class="text-xs uppercase tracking-[0.4em] text-amber-200">Writing</p>
    <h1 class="text-4xl font-bold text-slate-100">Field notes from the RevOps pipe bench</h1>
    <p class="mx-auto max-w-3xl text-lg text-slate-300">
      Longform essays, weekly dispatches, and experiments on leadership, tooling, craftsmanship, and
      the hospitality of great operations. Subscribe or dive into the archive below.
    </p>
  </section>

  <section class="mt-12 grid gap-6 md:grid-cols-2">
    {posts.map((post) => (
      <article class="group flex h-full flex-col justify-between rounded-3xl border border-slate-800/70 bg-slate-900/60 p-6 shadow-xl transition hover:border-amber-300/60 hover:shadow-amber-500/20">
        <div class="space-y-3">
          <p class="text-xs uppercase tracking-[0.4em] text-slate-500">
            <FormattedDate date={post.data.pubDate} />
          </p>
          <h2 class="text-2xl font-semibold text-slate-100 group-hover:text-amber-300">
            <a href={`/blog/${post.id}/`}>{post.data.title}</a>
          </h2>
          <p class="text-sm text-slate-300">{post.data.description}</p>
          {post.data.tags && (
            <div class="flex flex-wrap gap-2 text-xs uppercase tracking-[0.3em] text-slate-500">
              {post.data.tags.map((tag) => (
                <span class="rounded-full border border-slate-700 px-3 py-1">{tag}</span>
              ))}
            </div>
          )}
        </div>
        <a
          class="mt-6 inline-flex items-center gap-2 text-sm font-semibold text-amber-300 hover:text-amber-200"
          href={`/blog/${post.id}/`}
        >
          Read essay
          <span aria-hidden="true">→</span>
        </a>
      </article>
    ))}
  </section>
</SiteLayout>
